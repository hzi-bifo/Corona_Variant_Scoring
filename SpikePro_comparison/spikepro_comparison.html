
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="https://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.name/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.31</code>)
    by by by by by by by by by by by .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#### SpikePro Methods Comparison</span>
<span class="hl com">#Author: Katrina Norwood</span>
<span class="hl com">#Last Updated: 28/10/24</span>

<span class="hl com">#Script to compare the SpikePro immune escape prediction algorithm to our methods </span>
<span class="hl com">#weighing amino acid changes across the spike protein.</span>

<span class="hl com"># To run:</span>
<span class="hl com"># 1. start in the /Corona_Variant_Scoring/ home directory</span>
<span class="hl com"># 2. in command line run: ```Rscript SpikePro_comparison/spikepro_comparison.R```</span>

<span class="hl kwd">library</span><span class="hl std">(dplyr)</span>
<span class="hl kwd">library</span><span class="hl std">(ggplot2)</span>
<span class="hl kwd">library</span><span class="hl std">(psych)</span>

<span class="hl com"># Data Importation</span>

<span class="hl std">output</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;SpikePro_comparison/&quot;</span>
<span class="hl std">mfrn</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">&quot;validation/mfrn_mabs_vocs.csv&quot;</span><span class="hl std">,</span> <span class="hl kwc">sep</span> <span class="hl std">=</span> <span class="hl str">&quot;\t&quot;</span><span class="hl std">)</span>
<span class="hl std">antigenic_cartography_distances</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">&quot;validation/antigenic_cartography_distances.csv&quot;</span><span class="hl std">,</span> <span class="hl kwc">sep</span> <span class="hl std">=</span> <span class="hl str">&quot;,&quot;</span><span class="hl std">)</span>
<span class="hl std">method_antigenicScores_dir</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites&quot;</span>
<span class="hl std">method_spikepro_df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">&quot;SpikePro_comparison/spikepro_scores.csv&quot;</span><span class="hl std">,</span> <span class="hl kwc">sep</span> <span class="hl std">=</span> <span class="hl str">&quot;,&quot;</span><span class="hl std">)</span>

<span class="hl com">## Data Cleaning and Normalization for the mAb neutralization scores</span>

<span class="hl com"># Setting mAb names as the row names for clearer organization</span>
<span class="hl kwd">rownames</span><span class="hl std">(mfrn)</span> <span class="hl kwb">&lt;-</span> <span class="hl std">mfrn</span><span class="hl opt">$</span><span class="hl std">mAb</span>
<span class="hl std">mfrn</span><span class="hl opt">$</span><span class="hl std">mAb</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">NULL</span>
<span class="hl kwd">print</span><span class="hl std">(mfrn)</span>
</pre></div>
<div class="output"><pre class="knitr r">##              Alpha   Beta  Delta  Gamma   BA.1   BA.2 BA.1.1 BA.4_BA.5 BA.2.12.1
## Amubarvimab   0.38   0.62   0.80   0.49 180.00 200.00  220.0     85.00      97.0
## Casirivimab   0.91 110.00   0.71  89.00 630.00 670.00  910.0    710.00    1000.0
## DXP-604       0.75   8.10   1.70   0.55  19.00  17.00   18.0    570.00      19.0
## Etesevimab    9.30 320.00   0.52 270.00 410.00 460.00  530.0    320.00     510.0
## Regdanvimab   1.50  53.00  37.00  73.00 590.00 830.00 1000.0   1000.00        NA
## Tixagevimab   1.40   4.70   1.10   4.00 360.00 540.00  400.0    860.00     420.0
## Bamlanivimab  1.10 660.00 650.00 700.00 700.00 660.00  910.0    520.00     580.0
## Cilgavimab    0.73   1.00   3.20   0.82 220.00   2.70  820.0     11.00       3.6
## Bebtelovimab  1.00   0.84   1.50   1.00   1.10   0.91    1.1      0.97       1.1
## Imdevimab     0.52   0.62   2.20   0.54 600.00 230.00 1000.0    450.00     380.0
## Romlusevimab  0.32   6.70     NA   0.70   0.74   8.10   21.0     27.00      27.0
## Sotrovimab    1.80   1.00   1.10   0.79   3.30  21.00    2.4     20.00      18.0
## Amu_Rom       0.89   1.50   2.50   2.50  12.00  83.00  200.0    110.00      88.0
## Bam_Ete       1.60 520.00   1.10 410.00 740.00 750.00 1000.0    670.00     740.0
## Cas_Imd       0.77   2.20   1.10   1.40 840.00 300.00 1000.0    730.00     620.0
## Cil_Tix       0.95   2.10   0.93   0.99  75.00   7.30  310.0     74.00      21.0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Getting means of mfrn values per variant</span>
<span class="hl std">mfrn_means</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">()</span>
<span class="hl kwa">for</span> <span class="hl std">(column</span> <span class="hl kwa">in</span> <span class="hl kwd">colnames</span><span class="hl std">(mfrn)){</span>
  <span class="hl kwd">print</span><span class="hl std">(column)</span>
  <span class="hl std">mean_val</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">mean</span><span class="hl std">(mfrn[[column]],</span> <span class="hl kwc">na.rm</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
  <span class="hl std">mfrn_means</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">append</span><span class="hl std">(mfrn_means, mean_val)</span>
<span class="hl std">}</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Alpha&quot;
## [1] &quot;Beta&quot;
## [1] &quot;Delta&quot;
## [1] &quot;Gamma&quot;
## [1] &quot;BA.1&quot;
## [1] &quot;BA.2&quot;
## [1] &quot;BA.1.1&quot;
## [1] &quot;BA.4_BA.5&quot;
## [1] &quot;BA.2.12.1&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Making dataframe of mfrn mean values</span>
<span class="hl std">variant</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">colnames</span><span class="hl std">(mfrn)</span>
<span class="hl std">mfrn_df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(variant, mfrn_means)</span>
<span class="hl std">mfrn_df</span>
</pre></div>
<div class="output"><pre class="knitr r">##     variant mfrn_means
## 1     Alpha    1.49500
## 2      Beta  105.77375
## 3     Delta   47.03067
## 4     Gamma   97.23625
## 5      BA.1  336.32125
## 6      BA.2  298.75063
## 7    BA.1.1  521.40625
## 8 BA.4_BA.5  384.87313
## 9 BA.2.12.1  301.64667
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Data Cleaning for antigenic cartography distances</span>

<span class="hl com"># Calculating the euclidean distances from the D614G variant</span>
<span class="hl std">antigenic_cartography_distances</span>
</pre></div>
<div class="output"><pre class="knitr r">##      variant distance_from_D614G
## 1    B.1.1.7                 0.7
## 2    B.1.351                 3.6
## 3        P.1                 3.1
## 4    B.1.429                 0.3
## 5  B.1.617.2                 1.4
## 6       C.37                 1.1
## 7    B.1.621                 3.4
## 8       BA.1                 6.3
## 9     BA.1.1                 7.0
## 10      BA.2                 6.0
## 11 BA.2.12.1                 6.1
## 12 BA.4_BA.5                 6.3
## 13       XBB                 7.4
## 14  XBB.1.16                 7.9
## 15   XBB.1.5                 7.0
## 16   XBB.2.3                 7.6
## 17      EG.5                 7.5
## 18    EG.5.1                 7.3
## 19      JN.1                 6.6
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Changing the names of lineages to WHO format</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.1.7'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Alpha&quot;</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.351'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Beta&quot;</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'P.1'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Gamma&quot;</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.617.2'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Delta&quot;</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'C.37'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Lambda&quot;</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.617.1'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Kappa&quot;</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.429'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Epsilon&quot;</span>
<span class="hl std">antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant[antigenic_cartography_distances</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.621'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Mu&quot;</span>
<span class="hl std">antigenic_cartography_distances</span>
</pre></div>
<div class="output"><pre class="knitr r">##      variant distance_from_D614G
## 1      Alpha                 0.7
## 2       Beta                 3.6
## 3      Gamma                 3.1
## 4    Epsilon                 0.3
## 5      Delta                 1.4
## 6     Lambda                 1.1
## 7         Mu                 3.4
## 8       BA.1                 6.3
## 9     BA.1.1                 7.0
## 10      BA.2                 6.0
## 11 BA.2.12.1                 6.1
## 12 BA.4_BA.5                 6.3
## 13       XBB                 7.4
## 14  XBB.1.16                 7.9
## 15   XBB.1.5                 7.0
## 16   XBB.2.3                 7.6
## 17      EG.5                 7.5
## 18    EG.5.1                 7.3
## 19      JN.1                 6.6
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Data Cleaning for SpikePro Scores</span>

<span class="hl com"># Getting lineages for comparison</span>
<span class="hl com"># Here we don't take the BA.4 lineage since in the mFRN values its combined with BA.5 and we don't have that score for SpikePro</span>
<span class="hl std">variants_pangoLineage</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;B.1.1.7&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;B.1.351&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;P.1&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;B.1.617.2&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;BA.1&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;BA.2&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;BA.2.12.1&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;XBB.1.16&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;XBB.1.5&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;EG.5&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;EG.5.1&quot;</span><span class="hl std">)</span>
<span class="hl std">method_spikepro</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">subset</span><span class="hl std">(method_spikepro_df,</span> <span class="hl kwc">select</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(Pango.lineage, score))</span>
<span class="hl std">method_spikepro</span> <span class="hl kwb">&lt;-</span> <span class="hl std">method_spikepro</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">rename</span><span class="hl std">(</span><span class="hl kwc">variant</span> <span class="hl std">= Pango.lineage,</span> <span class="hl kwc">antigenic_score</span> <span class="hl std">= score)</span>
<span class="hl std">method_spikepro</span> <span class="hl kwb">&lt;-</span> <span class="hl std">method_spikepro[method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">%in%</span> <span class="hl std">variants_pangoLineage, ]</span>
<span class="hl std">method_spikepro</span>
</pre></div>
<div class="output"><pre class="knitr r">##      variant antigenic_score
## 1    B.1.1.7             6.1
## 2    B.1.351             7.4
## 3        P.1             8.3
## 4  B.1.617.2             6.9
## 5       BA.1            14.0
## 6       BA.2            12.0
## 7  BA.2.12.1            14.0
## 9   XBB.1.16            17.0
## 10   XBB.1.5            15.0
## 11      EG.5            13.0
## 12    EG.5.1            13.0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Renaming lineages</span>
<span class="hl std">method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant[method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.1.7'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Alpha&quot;</span>
<span class="hl std">method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant[method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.351'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Beta&quot;</span>
<span class="hl std">method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant[method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'P.1'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Gamma&quot;</span>
<span class="hl std">method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant[method_spikepro</span><span class="hl opt">$</span><span class="hl std">variant</span> <span class="hl opt">==</span> <span class="hl str">'B.1.617.2'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Delta&quot;</span>
<span class="hl std">method_spikepro</span>
</pre></div>
<div class="output"><pre class="knitr r">##      variant antigenic_score
## 1      Alpha             6.1
## 2       Beta             7.4
## 3      Gamma             8.3
## 4      Delta             6.9
## 5       BA.1            14.0
## 6       BA.2            12.0
## 7  BA.2.12.1            14.0
## 9   XBB.1.16            17.0
## 10   XBB.1.5            15.0
## 11      EG.5            13.0
## 12    EG.5.1            13.0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Data Cleaning for VOC Antigenic Scores</span>

<span class="hl std">create_dataframe</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">indir</span><span class="hl std">){</span>
  <span class="hl com"># Function for data import and cleaning for the antigenic scoring results</span>

  <span class="hl std">antigenicScores_df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(</span><span class="hl kwd">matrix</span><span class="hl std">(</span><span class="hl kwc">ncol</span> <span class="hl std">=</span> <span class="hl num">4</span><span class="hl std">,</span> <span class="hl kwc">nrow</span> <span class="hl std">=</span> <span class="hl num">0</span><span class="hl std">))</span>
  <span class="hl kwd">print</span><span class="hl std">(indir)</span>
  <span class="hl kwa">for</span> <span class="hl std">(file</span> <span class="hl kwa">in</span> <span class="hl kwd">list.files</span><span class="hl std">(</span><span class="hl kwc">path</span> <span class="hl std">= indir,</span> <span class="hl kwc">pattern</span> <span class="hl std">=</span> <span class="hl str">&quot;.csv&quot;</span><span class="hl std">,</span> <span class="hl kwc">all.files</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">,</span> <span class="hl kwc">full.names</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)) {</span>
    <span class="hl kwd">print</span><span class="hl std">(file)</span>
    <span class="hl std">df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl std">(file,</span> <span class="hl kwc">sep</span> <span class="hl std">=</span> <span class="hl str">&quot;\t&quot;</span><span class="hl std">)</span>
    <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl kwd">nrow</span><span class="hl std">(df))</span>
    <span class="hl std">variants_df</span> <span class="hl kwb">&lt;-</span> <span class="hl std">df[df</span><span class="hl opt">$</span><span class="hl std">Pango.lineage</span> <span class="hl opt">%in%</span> <span class="hl std">variants_pangoLineage, ]</span>
    <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl kwd">nrow</span><span class="hl std">(variants_df))</span>
    <span class="hl std">antigenicScores_df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(antigenicScores_df, variants_df)}</span>

  <span class="hl kwd">print</span><span class="hl std">(antigenicScores_df)</span>

  <span class="hl com"># Taking median antigenic score per pango lineage</span>
  <span class="hl std">antigenicScores_df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">select</span><span class="hl std">(antigenicScores_df,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Pango.lineage&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;antigenic_score&quot;</span><span class="hl std">))</span>
  <span class="hl com">#antigenicScores_df_mean &lt;- aggregate(.~Pango.lineage, antigenicScores_df, mean) # Here we take the mean score of the lineages</span>
  <span class="hl std">antigenicScores_df_mean</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">aggregate</span><span class="hl std">(.</span><span class="hl opt">~</span><span class="hl std">Pango.lineage, antigenicScores_df, median)</span> <span class="hl com"># Takes the median score of the lineages as there may have been high variance in each lineage based on the boxplot comparison</span>
  <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;antigenicScores_df_mean: &quot;</span><span class="hl std">)</span>
  <span class="hl kwd">print</span><span class="hl std">(antigenicScores_df_mean)</span>

  <span class="hl com"># Renaming Pango lineages</span>
  <span class="hl std">antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage[antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage</span> <span class="hl opt">==</span> <span class="hl str">'B.1.1.7'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Alpha&quot;</span>
  <span class="hl std">antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage[antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage</span> <span class="hl opt">==</span> <span class="hl str">'B.1.351'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Beta&quot;</span>
  <span class="hl std">antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage[antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage</span> <span class="hl opt">==</span> <span class="hl str">'P.1'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Gamma&quot;</span>
  <span class="hl std">antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage[antigenicScores_df_mean</span><span class="hl opt">$</span><span class="hl std">Pango.lineage</span> <span class="hl opt">==</span> <span class="hl str">'B.1.617.2'</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;Delta&quot;</span>
  <span class="hl std">antigenicScores_df_renamed</span> <span class="hl kwb">&lt;-</span> <span class="hl std">antigenicScores_df_mean</span>
  <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;antigenicScores_df_mean: &quot;</span><span class="hl std">)</span>
  <span class="hl kwd">print</span><span class="hl std">(antigenicScores_df_mean)</span>
  <span class="hl std">antigenicScores_df_renamed</span> <span class="hl kwb">&lt;-</span> <span class="hl std">antigenicScores_df_renamed</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">rename_at</span><span class="hl std">(</span><span class="hl str">'Pango.lineage'</span><span class="hl std">,</span> <span class="hl opt">~</span><span class="hl str">'variant'</span><span class="hl std">)</span>
  <span class="hl com">#antigenicScores_df_renamed &lt;- antigenicScores_df_renamed[-c(10,11), ] </span>
  <span class="hl kwd">print</span><span class="hl std">(antigenicScores_df_renamed)</span>

  <span class="hl kwd">return</span><span class="hl std">(antigenicScores_df_renamed)</span>
<span class="hl std">}</span>

<span class="hl std">method_antigenicScores</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">create_dataframe</span><span class="hl std">(method_antigenicScores_dir)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites&quot;
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-01.csv&quot;
## [1] 27
## [1] 1
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-02.csv&quot;
## [1] 57
## [1] 1
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-03.csv&quot;
## [1] 433
## [1] 3
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-04.csv&quot;
## [1] 583
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-05.csv&quot;
## [1] 646
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-06.csv&quot;
## [1] 697
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-07.csv&quot;
## [1] 699
## [1] 3
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-08.csv&quot;
## [1] 713
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-09.csv&quot;
## [1] 737
## [1] 5
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-10.csv&quot;
## [1] 777
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-11.csv&quot;
## [1] 767
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2020-12.csv&quot;
## [1] 784
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-01.csv&quot;
## [1] 852
## [1] 6
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-02.csv&quot;
## [1] 737
## [1] 6
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-03.csv&quot;
## [1] 644
## [1] 5
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-04.csv&quot;
## [1] 533
## [1] 6
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-05.csv&quot;
## [1] 483
## [1] 6
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-06.csv&quot;
## [1] 419
## [1] 5
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-07.csv&quot;
## [1] 419
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-08.csv&quot;
## [1] 403
## [1] 4
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-09.csv&quot;
## [1] 383
## [1] 5
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-10.csv&quot;
## [1] 370
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-11.csv&quot;
## [1] 399
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2021-12.csv&quot;
## [1] 416
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-01.csv&quot;
## [1] 510
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-02.csv&quot;
## [1] 412
## [1] 9
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-03.csv&quot;
## [1] 358
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-04.csv&quot;
## [1] 363
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-05.csv&quot;
## [1] 425
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-06.csv&quot;
## [1] 489
## [1] 6
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-07.csv&quot;
## [1] 541
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-08.csv&quot;
## [1] 605
## [1] 6
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-09.csv&quot;
## [1] 686
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-10.csv&quot;
## [1] 805
## [1] 5
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-11.csv&quot;
## [1] 916
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2022-12.csv&quot;
## [1] 1007
## [1] 6
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-01.csv&quot;
## [1] 1111
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-02.csv&quot;
## [1] 1099
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-03.csv&quot;
## [1] 1134
## [1] 9
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-04.csv&quot;
## [1] 1073
## [1] 9
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-05.csv&quot;
## [1] 966
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-06.csv&quot;
## [1] 812
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-07.csv&quot;
## [1] 759
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-08.csv&quot;
## [1] 694
## [1] 10
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-09.csv&quot;
## [1] 619
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-10.csv&quot;
## [1] 532
## [1] 7
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-11.csv&quot;
## [1] 443
## [1] 8
## [1] &quot;validation/methods_validation_data/WHO_ranked_weights_at_all_sites/antigenic_scores_ranked_with_WHO_2023-12.csv&quot;
## [1] 288
## [1] 6
##      Pango.lineage antigenic_score   rank              WHO_label
## 2          B.1.351       1.5003333    2.0                   Beta
## 1          B.1.351       3.3402381    1.0                   Beta
## 11             P.1       5.5076706    1.0                  Gamma
## 3          B.1.351       3.7275714    3.0                   Beta
## 6          B.1.1.7       3.3330833    6.0                  Alpha
## 21             P.1       5.0378829    2.0                  Gamma
## 5          B.1.1.7       3.2049167    5.0                  Alpha
## 61         B.1.351       2.7581667    6.0                   Beta
## 388      B.1.617.2       0.2603333  427.5                  Delta
## 22         B.1.351       5.2980298    2.0                   Beta
## 31             P.1       4.4433363    3.0                  Gamma
## 8          B.1.1.7       3.6116869    8.0                  Alpha
## 611      B.1.617.2       0.8686364   61.0                  Delta
## 32         B.1.351       4.8080119    3.0                   Beta
## 81             P.1       2.8110278    8.0                  Gamma
## 111        B.1.1.7       2.0003333   11.0                  Alpha
## 75       B.1.617.2       0.7906753   75.0                  Delta
## 23         B.1.351       3.9012857    2.0                   Beta
## 9          B.1.1.7       2.5803772    9.0                  Alpha
## 16       B.1.617.2       2.0665805   16.0                  Delta
## 33             P.1       5.5076706    3.0                  Gamma
## 4          B.1.351       4.6487679    4.0                   Beta
## 24         B.1.1.7       2.0471190   24.0                  Alpha
## 68       B.1.617.2       1.2202317   68.0                  Delta
## 12            BA.1      16.0654008    1.0                Omicron
## 41         B.1.351       4.6097909    4.0                   Beta
## 62         B.1.1.7       3.3293978    6.0                  Alpha
## 91             P.1       2.9697778    9.0                  Gamma
## 69       B.1.617.2       1.3573070   69.0                  Delta
## 13             P.1       5.9138264    1.0                  Gamma
## 34         B.1.351       4.4923913    3.0                   Beta
## 63         B.1.1.7       3.4813170    6.0                  Alpha
## 74       B.1.617.2       1.4604224   74.0                  Delta
## 42             P.1       5.2209804    4.0                  Gamma
## 64         B.1.351       4.7136831    6.0                   Beta
## 92         B.1.1.7       3.4848006    9.0                  Alpha
## 216      B.1.617.2       0.9051121  216.0                  Delta
## 82         B.1.351       4.7763272    8.0                   Beta
## 93             P.1       4.7254022    9.0                  Gamma
## 18         B.1.1.7       3.5007545   18.0                  Alpha
## 226      B.1.617.2       0.9840129  226.0                  Delta
## 83            BA.1      13.6483700    8.0                Omicron
## 94            BA.2       8.5475733    9.0                Omicron
## 19             P.1       5.2897908   19.0                  Gamma
## 231        B.1.351       4.8243806   23.0                   Beta
## 36         B.1.1.7       3.5504930   36.0                  Alpha
## 181      B.1.617.2       1.5170913  181.0                  Delta
## 65            BA.2      12.1665189    6.0                Omicron
## 7             BA.1      11.9778303    7.0                Omicron
## 191            P.1       5.3861870   19.0                  Gamma
## 241        B.1.351       4.9142014   24.0                   Beta
## 44         B.1.1.7       3.5651063   44.0                  Alpha
## 170      B.1.617.2       1.6431392  170.0                  Delta
## 35            BA.1      17.0729008    3.0                Omicron
## 182            P.1       5.3497944   18.0                  Gamma
## 242        B.1.351       4.9200411   24.0                   Beta
## 43         B.1.1.7       3.6060669   43.0                  Alpha
## 246      B.1.617.2       1.3563153  245.0                  Delta
## 14            BA.1      13.2336647    1.0                Omicron
## 161            P.1       5.3957401   16.0                  Gamma
## 26            BA.2       5.1333166   26.0                Omicron
## 28         B.1.351       4.9205925   28.0                   Beta
## 53         B.1.1.7       3.6362797   53.0                  Alpha
## 261      B.1.617.2       1.4665002  260.0                  Delta
## 25            BA.1      15.2232897    2.0                Omicron
## 45            BA.2       8.6009112    4.0                Omicron
## 232            P.1       5.3780528   23.0                  Gamma
## 341        B.1.351       4.9114169   34.0                   Beta
## 58         B.1.1.7       3.6959066   58.0                  Alpha
## 272      B.1.617.2       1.6043735  271.0                  Delta
## 262            P.1       5.4482468   26.0                  Gamma
## 342           BA.2       5.2050792   34.0                Omicron
## 361        B.1.351       4.9663272   36.0                   Beta
## 581        B.1.1.7       3.7137893   58.0                  Alpha
## 229      B.1.617.2       1.7855878  229.0                  Delta
## 243            P.1       5.4453002   24.0                  Gamma
## 30         B.1.351       5.0489303   30.0                   Beta
## 54         B.1.1.7       3.7324256   54.0                  Alpha
## 220      B.1.617.2       1.8699752  220.0                  Delta
## 251            P.1       5.4104196   25.0                  Gamma
## 29         B.1.351       5.2771757   29.0                   Beta
## 541        B.1.1.7       3.7479762   54.0                  Alpha
## 206      B.1.617.2       1.9636049  206.0                  Delta
## 27             P.1       5.3392254   27.0                  Gamma
## 321        B.1.351       5.1182964   32.0                   Beta
## 421        B.1.1.7       3.9899968   42.0                  Alpha
## 531           BA.1       3.5732778   53.0                Omicron
## 209      B.1.617.2       1.9070931  208.0                  Delta
## 210        XBB.1.5      22.0349677    2.0 Non Variant of Concern
## 252           BA.2      12.6760672   25.0                Omicron
## 263           BA.1      12.1633661   26.0                Omicron
## 47             P.1       5.3216527   47.0                  Gamma
## 50         B.1.351       4.6709760   50.0                   Beta
## 582        B.1.1.7       4.0920395   58.0                  Alpha
## 221      B.1.617.2       2.0266384  220.0                  Delta
## 131      BA.2.12.1      16.3636378   13.0                Omicron
## 532           BA.2      14.6841813   53.0                Omicron
## 612           BA.1      14.4768819   61.0                Omicron
## 84         B.1.351       5.2391549   84.0                   Beta
## 85             P.1       5.2162524   85.0                  Gamma
## 105        B.1.1.7       3.9264236  105.0                  Alpha
## 270      B.1.617.2       2.0984834  269.0                  Delta
## 46         XBB.1.5      18.9027177    4.0 Non Variant of Concern
## 302      BA.2.12.1      15.8150413   30.0                Omicron
## 77            BA.1      14.5034154   77.0                Omicron
## 911           BA.2      13.4043734   91.0                Omicron
## 112        B.1.351       6.0313434  112.0                   Beta
## 123            P.1       4.4115367  123.0                  Gamma
## 139        B.1.1.7       3.7835482  139.0                  Alpha
## 301      B.1.617.2       2.0949740  300.0                  Delta
## 291        XBB.1.5      18.7912242   29.0 Non Variant of Concern
## 160           BA.1      15.2269099  160.0                Omicron
## 166      BA.2.12.1      15.0939621  166.0                Omicron
## 208           BA.2      13.9717471  208.0                Omicron
## 2621           P.1       7.4487817  262.0                  Gamma
## 266        B.1.351       6.3934201  266.0                   Beta
## 299        B.1.1.7       3.4648686  299.0                  Alpha
## 431      B.1.617.2       2.1199955  430.0                  Delta
## 113        XBB.1.5      19.3316661   11.0 Non Variant of Concern
## 912           BA.1      15.7342219   91.0                Omicron
## 108      BA.2.12.1      15.5396192  108.0                Omicron
## 194           BA.2      14.4548601  194.0                Omicron
## 253       XBB.1.16      10.5298885  253.0 Non Variant of Concern
## 259        B.1.351       8.2775873  259.0                   Beta
## 2631           P.1       6.2005357  263.0                  Gamma
## 268        B.1.1.7       4.5074235  268.0                  Alpha
## 380      B.1.617.2       1.9030946  379.0                  Delta
## 66         XBB.1.5      20.5645339    6.0 Non Variant of Concern
## 821      BA.2.12.1      15.7921914   82.0                Omicron
## 86            BA.1      15.6454442   86.0                Omicron
## 188           BA.2      14.7248043  188.0                Omicron
## 2611       B.1.351       5.2180866  261.0                   Beta
## 274        B.1.1.7       4.0235036  274.0                  Alpha
## 304      B.1.617.2       2.6007664  304.0                  Delta
## 114        XBB.1.5      19.3459493   11.0 Non Variant of Concern
## 1051     BA.2.12.1      15.5297778  105.0                Omicron
## 183           BA.1      14.9344766  183.0                Omicron
## 224           BA.2      14.6111602  224.0                Omicron
## 2911       B.1.1.7       8.2225262  291.0                  Alpha
## 297            P.1       5.5076706  297.0                  Gamma
## 324      B.1.617.2       2.9716654  324.0                  Delta
## 71         XBB.1.5      20.3702177    7.0 Non Variant of Concern
## 211       XBB.1.16      17.8383389   21.0 Non Variant of Concern
## 751           BA.1      15.9624684   75.0                Omicron
## 921      BA.2.12.1      15.7268707   92.0                Omicron
## 282           BA.2      14.6330742  282.0                Omicron
## 356        B.1.1.7       6.5969785  356.0                  Alpha
## 368            P.1       4.0938120  368.0                  Gamma
## 390      B.1.617.2       2.4728772  390.0                  Delta
## 941      BA.2.12.1      15.8073715   94.0                Omicron
## 286           BA.1      14.9907117  286.0                Omicron
## 330           BA.2      14.6281313  330.0                Omicron
## 432        B.1.1.7       5.7838586  432.0                  Alpha
## 433            P.1       5.5076706  433.5                  Gamma
## 469      B.1.617.2       2.0174935  469.0                  Delta
## 138      BA.2.12.1      15.8633557  138.0                Omicron
## 236           BA.1      15.3633675  236.0                Omicron
## 420        XBB.1.5      14.4685888  420.0 Non Variant of Concern
## 429           BA.2      14.4012438  429.0                Omicron
## 506        B.1.1.7       5.9782500  506.0                  Alpha
## 508            P.1       5.5076706  508.0                  Gamma
## 5311     B.1.617.2       1.7963170  531.0                  Delta
## 121        XBB.1.5      20.3702177   12.5 Non Variant of Concern
## 180           BA.1      16.2098802  179.0                Omicron
## 2291     BA.2.12.1      15.8786591  228.0                Omicron
## 548           BA.2      13.4527743  547.0                Omicron
## 580        B.1.351       8.2979345  579.0                   Beta
## 596      B.1.617.2       2.3261919  595.0                  Delta
## 3241     BA.2.12.1      15.9548329  323.0                Omicron
## 568           BA.1      14.9769439  567.0                Omicron
## 636           BA.2      12.5237081  635.0                Omicron
## 648        XBB.1.5      10.8388671  647.0 Non Variant of Concern
## 655        B.1.351       8.9366232  654.0                   Beta
## 656        B.1.1.7       8.8591349  655.0                  Alpha
## 682      B.1.617.2       1.9235814  681.0                  Delta
## 227        XBB.1.5      17.9775027  226.0 Non Variant of Concern
## 413      BA.2.12.1      16.3496381  412.0                Omicron
## 552           BA.1      15.6901308  551.0                Omicron
## 775           BA.2      12.5986056  774.0                Omicron
## 794      B.1.617.2       3.6408598  793.0                  Delta
## 200        XBB.1.5      19.3953009  200.0 Non Variant of Concern
## 277       XBB.1.16      18.4302177  276.0 Non Variant of Concern
## 551      BA.2.12.1      16.2988044  550.0                Omicron
## 867           BA.1      14.6071548  866.0                Omicron
## 885           BA.2      13.6248700  884.0                Omicron
## 908      B.1.617.2       3.7472883  907.0                  Delta
## 909        B.1.1.7       3.4328333  908.0                  Alpha
## 613       XBB.1.16      20.7862177   61.0 Non Variant of Concern
## 2661       XBB.1.5      19.6087780  266.0 Non Variant of Concern
## 849           BA.1      15.5317700  848.0                Omicron
## 970      BA.2.12.1      14.1664226  969.0                Omicron
## 976           BA.2      13.5687171  975.0                Omicron
## 996      B.1.617.2       3.8655498  995.0                  Delta
## 87          EG.5.1      22.1206344    8.0 Non Variant of Concern
## 2912       XBB.1.5      19.6748272  291.0 Non Variant of Concern
## 544           BA.1      17.5677659  543.0                Omicron
## 633       XBB.1.16      17.0092800  632.0 Non Variant of Concern
## 823      BA.2.12.1      16.1793169  822.0                Omicron
## 1074          BA.2      13.6504154 1073.0                Omicron
## 1102     B.1.617.2       5.3440959 1101.0                  Delta
## 327        XBB.1.5      19.6129664  327.0 Non Variant of Concern
## 540           EG.5      18.2168844  539.0 Non Variant of Concern
## 694      BA.2.12.1      17.1036209  693.0                Omicron
## 720       XBB.1.16      16.9768751  719.0 Non Variant of Concern
## 1025          BA.1      15.3251816 1024.0                Omicron
## 1083          BA.2      12.3223277 1082.0                Omicron
## 1093       B.1.351       4.9573095 1092.0                   Beta
## 1095     B.1.617.2       3.7329737 1094.0                  Delta
## 387        XBB.1.5      19.6036373  387.0 Non Variant of Concern
## 503           EG.5      19.1966841  502.0 Non Variant of Concern
## 561         EG.5.1      18.8920143  560.0 Non Variant of Concern
## 804       XBB.1.16      16.8575840  803.0 Non Variant of Concern
## 995           BA.1      15.7768283  994.0                Omicron
## 1067     BA.2.12.1      14.8577440 1066.0                Omicron
## 1110          BA.2      11.7926750 1109.0                Omicron
## 1123     B.1.617.2       6.4744731 1122.0                  Delta
## 1126       B.1.1.7       3.8455524 1125.0                  Alpha
## 95          EG.5.1      21.3224775   95.0 Non Variant of Concern
## 419      BA.2.12.1      19.6837314  419.0                Omicron
## 436           EG.5      19.6305037  436.0 Non Variant of Concern
## 438        XBB.1.5      19.6257520  438.0 Non Variant of Concern
## 782           BA.1      17.2417339  782.0                Omicron
## 813       XBB.1.16      17.0413292  813.0 Non Variant of Concern
## 1048          BA.2      11.0960657 1048.0                Omicron
## 1056       B.1.351       9.0743054 1056.0                   Beta
## 1062           P.1       5.5076706 1062.0                  Gamma
## 115         EG.5.1      21.2034070  115.0 Non Variant of Concern
## 2622     BA.2.12.1      20.4156209  262.0                Omicron
## 472        XBB.1.5      19.5958511  472.0 Non Variant of Concern
## 647       XBB.1.16      18.7450365  647.0 Non Variant of Concern
## 710           EG.5      18.0902144  710.0 Non Variant of Concern
## 946           BA.2      10.6602401  946.0                Omicron
## 953      B.1.617.2       8.9097959  953.0                  Delta
## 956           BA.1       7.9068825  956.0                Omicron
## 15            BA.1      22.4898041   15.0                Omicron
## 2271        EG.5.1      20.5991052  227.0 Non Variant of Concern
## 456        XBB.1.5      19.5763925  456.0 Non Variant of Concern
## 586       XBB.1.16      18.8286131  586.0 Non Variant of Concern
## 671      BA.2.12.1      17.8535166  671.0                Omicron
## 717           EG.5      16.9632235  717.0 Non Variant of Concern
## 791           BA.2      14.7099653  791.0                Omicron
## 806      B.1.617.2       8.8322805  806.0                  Delta
## 218         EG.5.1      20.6729889  218.0 Non Variant of Concern
## 364           BA.1      19.9273818  364.0                Omicron
## 485        XBB.1.5      19.4481765  485.0 Non Variant of Concern
## 542      BA.2.12.1      19.0519849  542.0                Omicron
## 547       XBB.1.16      19.0227132  547.0 Non Variant of Concern
## 681           EG.5      16.7469338  681.0 Non Variant of Concern
## 723           BA.2      15.2785504  723.0                Omicron
## 732      B.1.617.2      14.8585820  732.0                  Delta
## 2161        EG.5.1      20.8246310  216.0 Non Variant of Concern
## 441        XBB.1.5      19.6082693  441.0 Non Variant of Concern
## 5061      XBB.1.16      19.1600404  506.0 Non Variant of Concern
## 584      BA.2.12.1      17.8859730  584.0                Omicron
## 595           EG.5      17.6327067  595.0 Non Variant of Concern
## 650           BA.2      15.8992920  650.0                Omicron
## 689        B.1.351       4.9552381  689.0                   Beta
## 690      B.1.617.2       4.0752789  690.0                  Delta
## 691        B.1.1.7       3.4328333  691.0                  Alpha
## 693           BA.1       0.6800000  693.0                Omicron
## 1941        EG.5.1      20.9436786  194.0 Non Variant of Concern
## 378        XBB.1.5      19.8864302  378.0 Non Variant of Concern
## 455       XBB.1.16      19.3951414  455.0 Non Variant of Concern
## 475           BA.1      19.1775554  475.0                Omicron
## 5401          EG.5      17.9059458  540.0 Non Variant of Concern
## 5951          BA.2      15.0488499  595.0                Omicron
## 6121     BA.2.12.1      11.7382669  612.0                Omicron
## 186         EG.5.1      21.1485124  186.0 Non Variant of Concern
## 308       XBB.1.16      20.2329149  308.0 Non Variant of Concern
## 338        XBB.1.5      20.0083997  338.0 Non Variant of Concern
## 461           EG.5      18.1205305  461.0 Non Variant of Concern
## 490           BA.1      16.7804719  490.0                Omicron
## 519           BA.2      12.7584814  519.0                Omicron
## 529        B.1.1.7       8.3559102  529.0                  Alpha
## 126       XBB.1.16      21.5483590  126.0 Non Variant of Concern
## 174         EG.5.1      21.2379590  174.0 Non Variant of Concern
## 305        XBB.1.5      20.1119244  305.0 Non Variant of Concern
## 343           BA.1      19.4728137  343.0                Omicron
## 372           EG.5      18.8157035  372.0 Non Variant of Concern
## 3781     BA.2.12.1      18.5555128  378.0                Omicron
## 410           BA.2      16.8600644  410.0                Omicron
## 4411       B.1.1.7       8.3559102  441.0                  Alpha
## 100       XBB.1.16      21.8081051  100.0 Non Variant of Concern
## 124         EG.5.1      21.3796390  124.0 Non Variant of Concern
## 2061       XBB.1.5      19.9626083  206.0 Non Variant of Concern
## 257           EG.5      18.1669042  257.0 Non Variant of Concern
## 264           BA.2      17.3373272  264.0                Omicron
## 267      BA.2.12.1      17.0411570  267.0                Omicron
## [1] &quot;antigenicScores_df_mean: &quot;
##    Pango.lineage antigenic_score
## 1        B.1.1.7        3.695907
## 2        B.1.351        4.920317
## 3      B.1.617.2        1.990549
## 4           BA.1       15.363367
## 5           BA.2       13.596794
## 6      BA.2.12.1       15.954833
## 7           EG.5       18.120531
## 8         EG.5.1       21.148512
## 9            P.1        5.382120
## 10      XBB.1.16       18.786825
## 11       XBB.1.5       19.608269
## [1] &quot;antigenicScores_df_mean: &quot;
##    Pango.lineage antigenic_score
## 1          Alpha        3.695907
## 2           Beta        4.920317
## 3          Delta        1.990549
## 4           BA.1       15.363367
## 5           BA.2       13.596794
## 6      BA.2.12.1       15.954833
## 7           EG.5       18.120531
## 8         EG.5.1       21.148512
## 9          Gamma        5.382120
## 10      XBB.1.16       18.786825
## 11       XBB.1.5       19.608269
##      variant antigenic_score
## 1      Alpha        3.695907
## 2       Beta        4.920317
## 3      Delta        1.990549
## 4       BA.1       15.363367
## 5       BA.2       13.596794
## 6  BA.2.12.1       15.954833
## 7       EG.5       18.120531
## 8     EG.5.1       21.148512
## 9      Gamma        5.382120
## 10  XBB.1.16       18.786825
## 11   XBB.1.5       19.608269
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">method_antigenicScores</span>
</pre></div>
<div class="output"><pre class="knitr r">##      variant antigenic_score
## 1      Alpha        3.695907
## 2       Beta        4.920317
## 3      Delta        1.990549
## 4       BA.1       15.363367
## 5       BA.2       13.596794
## 6  BA.2.12.1       15.954833
## 7       EG.5       18.120531
## 8     EG.5.1       21.148512
## 9      Gamma        5.382120
## 10  XBB.1.16       18.786825
## 11   XBB.1.5       19.608269
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Data Visualization</span>

<span class="hl std">data_visualization</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">antigenic_scores_df</span><span class="hl std">,</span> <span class="hl kwc">antigenic_distances_df</span><span class="hl std">,</span> <span class="hl kwc">mfrn_df</span><span class="hl std">) {</span>
  <span class="hl com"># Function for merging mFRN values, antigenic distances, and antigenic scores for a final DF for visualization</span>

  <span class="hl com"># Creating one data frame with all comparisons</span>
  <span class="hl std">antigenicScores_df_filtered</span> <span class="hl kwb">&lt;-</span> <span class="hl std">antigenic_scores_df</span> <span class="hl com"># Copying input data</span>
  <span class="hl std">antigenicScores_df_filtered</span><span class="hl opt">$</span><span class="hl std">antigenic_score</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.numeric</span><span class="hl std">(antigenicScores_df_filtered</span><span class="hl opt">$</span><span class="hl std">antigenic_score)</span>
  <span class="hl std">antigenic_distances_df</span><span class="hl opt">$</span><span class="hl std">comparison</span> <span class="hl kwb">&lt;-</span> <span class="hl str">'Antigenic Distances'</span>
  <span class="hl std">antigenic_distances_df</span> <span class="hl kwb">&lt;-</span> <span class="hl std">antigenic_distances_df</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">rename_at</span><span class="hl std">(</span><span class="hl str">'distance_from_D614G'</span><span class="hl std">,</span> <span class="hl opt">~</span><span class="hl str">'value'</span><span class="hl std">)</span>
  <span class="hl std">merged1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">merge</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= antigenic_distances_df,</span> <span class="hl kwc">y</span> <span class="hl std">= antigenicScores_df_filtered,</span> <span class="hl kwc">by</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;variant&quot;</span><span class="hl std">))</span>
  <span class="hl std">mfrn_df</span><span class="hl opt">$</span><span class="hl std">comparison</span> <span class="hl kwb">&lt;-</span> <span class="hl str">'mFRN Values'</span>

  <span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl str">'mfrn_means'</span> <span class="hl opt">%in%</span> <span class="hl kwd">names</span><span class="hl std">(mfrn_df)) {</span>
    <span class="hl std">mfrn_df</span> <span class="hl kwb">&lt;-</span> <span class="hl std">mfrn_df</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">rename_at</span><span class="hl std">(</span><span class="hl str">'mfrn_means'</span><span class="hl std">,</span> <span class="hl opt">~</span><span class="hl str">'value'</span><span class="hl std">)}</span> <span class="hl kwa">else</span> <span class="hl std">{</span>
      <span class="hl std">mfrn_df</span> <span class="hl kwb">&lt;-</span> <span class="hl std">mfrn_df</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">rename_at</span><span class="hl std">(</span><span class="hl str">'mfrn_medians'</span><span class="hl std">,</span> <span class="hl opt">~</span><span class="hl str">'value'</span><span class="hl std">)}</span>
  <span class="hl std">merged2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">merge</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= mfrn_df,</span> <span class="hl kwc">y</span> <span class="hl std">= antigenicScores_df_filtered,</span> <span class="hl kwc">by</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;variant&quot;</span><span class="hl std">))</span>

  <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;merged1: &quot;</span><span class="hl std">)</span>
  <span class="hl kwd">print</span><span class="hl std">(merged1)</span>
  <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;merged2: &quot;</span><span class="hl std">)</span>
  <span class="hl kwd">print</span><span class="hl std">(merged2)</span>

  <span class="hl std">df4</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rbind</span><span class="hl std">(merged1, merged2)</span>
  <span class="hl std">df4</span><span class="hl opt">$</span><span class="hl std">value</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">round</span><span class="hl std">(df4</span><span class="hl opt">$</span><span class="hl std">value,</span> <span class="hl kwc">digits</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">)</span>
  <span class="hl std">df4</span><span class="hl opt">$</span><span class="hl std">antigenic_score</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">round</span><span class="hl std">(df4</span><span class="hl opt">$</span><span class="hl std">antigenic_score,</span> <span class="hl kwc">digits</span> <span class="hl std">=</span> <span class="hl num">2</span><span class="hl std">)</span>
  <span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;Final df: &quot;</span><span class="hl std">)</span>
  <span class="hl kwd">print</span><span class="hl std">(df4)</span>

  <span class="hl kwd">return</span><span class="hl std">(df4)</span>
<span class="hl std">}</span>

<span class="hl com"># Mean mFRN values used</span>
<span class="hl std">method_df_vis</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data_visualization</span><span class="hl std">(method_antigenicScores, antigenic_cartography_distances, mfrn_df)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;merged1: &quot;
##      variant value          comparison antigenic_score
## 1      Alpha   0.7 Antigenic Distances        3.695907
## 2       BA.1   6.3 Antigenic Distances       15.363367
## 3       BA.2   6.0 Antigenic Distances       13.596794
## 4  BA.2.12.1   6.1 Antigenic Distances       15.954833
## 5       Beta   3.6 Antigenic Distances        4.920317
## 6      Delta   1.4 Antigenic Distances        1.990549
## 7       EG.5   7.5 Antigenic Distances       18.120531
## 8     EG.5.1   7.3 Antigenic Distances       21.148512
## 9      Gamma   3.1 Antigenic Distances        5.382120
## 10  XBB.1.16   7.9 Antigenic Distances       18.786825
## 11   XBB.1.5   7.0 Antigenic Distances       19.608269
## [1] &quot;merged2: &quot;
##     variant     value  comparison antigenic_score
## 1     Alpha   1.49500 mFRN Values        3.695907
## 2      BA.1 336.32125 mFRN Values       15.363367
## 3      BA.2 298.75063 mFRN Values       13.596794
## 4 BA.2.12.1 301.64667 mFRN Values       15.954833
## 5      Beta 105.77375 mFRN Values        4.920317
## 6     Delta  47.03067 mFRN Values        1.990549
## 7     Gamma  97.23625 mFRN Values        5.382120
## [1] &quot;Final df: &quot;
##      variant  value          comparison antigenic_score
## 1      Alpha   0.70 Antigenic Distances            3.70
## 2       BA.1   6.30 Antigenic Distances           15.36
## 3       BA.2   6.00 Antigenic Distances           13.60
## 4  BA.2.12.1   6.10 Antigenic Distances           15.95
## 5       Beta   3.60 Antigenic Distances            4.92
## 6      Delta   1.40 Antigenic Distances            1.99
## 7       EG.5   7.50 Antigenic Distances           18.12
## 8     EG.5.1   7.30 Antigenic Distances           21.15
## 9      Gamma   3.10 Antigenic Distances            5.38
## 10  XBB.1.16   7.90 Antigenic Distances           18.79
## 11   XBB.1.5   7.00 Antigenic Distances           19.61
## 12     Alpha   1.50         mFRN Values            3.70
## 13      BA.1 336.32         mFRN Values           15.36
## 14      BA.2 298.75         mFRN Values           13.60
## 15 BA.2.12.1 301.65         mFRN Values           15.95
## 16      Beta 105.77         mFRN Values            4.92
## 17     Delta  47.03         mFRN Values            1.99
## 18     Gamma  97.24         mFRN Values            5.38
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_df_vis</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data_visualization</span><span class="hl std">(method_spikepro, antigenic_cartography_distances, mfrn_df)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;merged1: &quot;
##      variant value          comparison antigenic_score
## 1      Alpha   0.7 Antigenic Distances             6.1
## 2       BA.1   6.3 Antigenic Distances            14.0
## 3       BA.2   6.0 Antigenic Distances            12.0
## 4  BA.2.12.1   6.1 Antigenic Distances            14.0
## 5       Beta   3.6 Antigenic Distances             7.4
## 6      Delta   1.4 Antigenic Distances             6.9
## 7       EG.5   7.5 Antigenic Distances            13.0
## 8     EG.5.1   7.3 Antigenic Distances            13.0
## 9      Gamma   3.1 Antigenic Distances             8.3
## 10  XBB.1.16   7.9 Antigenic Distances            17.0
## 11   XBB.1.5   7.0 Antigenic Distances            15.0
## [1] &quot;merged2: &quot;
##     variant     value  comparison antigenic_score
## 1     Alpha   1.49500 mFRN Values             6.1
## 2      BA.1 336.32125 mFRN Values            14.0
## 3      BA.2 298.75063 mFRN Values            12.0
## 4 BA.2.12.1 301.64667 mFRN Values            14.0
## 5      Beta 105.77375 mFRN Values             7.4
## 6     Delta  47.03067 mFRN Values             6.9
## 7     Gamma  97.23625 mFRN Values             8.3
## [1] &quot;Final df: &quot;
##      variant  value          comparison antigenic_score
## 1      Alpha   0.70 Antigenic Distances             6.1
## 2       BA.1   6.30 Antigenic Distances            14.0
## 3       BA.2   6.00 Antigenic Distances            12.0
## 4  BA.2.12.1   6.10 Antigenic Distances            14.0
## 5       Beta   3.60 Antigenic Distances             7.4
## 6      Delta   1.40 Antigenic Distances             6.9
## 7       EG.5   7.50 Antigenic Distances            13.0
## 8     EG.5.1   7.30 Antigenic Distances            13.0
## 9      Gamma   3.10 Antigenic Distances             8.3
## 10  XBB.1.16   7.90 Antigenic Distances            17.0
## 11   XBB.1.5   7.00 Antigenic Distances            15.0
## 12     Alpha   1.50         mFRN Values             6.1
## 13      BA.1 336.32         mFRN Values            14.0
## 14      BA.2 298.75         mFRN Values            12.0
## 15 BA.2.12.1 301.65         mFRN Values            14.0
## 16      Beta 105.77         mFRN Values             7.4
## 17     Delta  47.03         mFRN Values             6.9
## 18     Gamma  97.24         mFRN Values             8.3
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Visualization</span>

<span class="hl std">scatterplot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span> <span class="hl std">(</span><span class="hl kwc">method_df_vis</span><span class="hl std">,</span> <span class="hl kwc">ylim</span><span class="hl std">,</span> <span class="hl kwc">file_name</span><span class="hl std">,</span> <span class="hl kwc">ylabel</span><span class="hl std">) {</span>
  <span class="hl std">method_plt</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl std">(method_df_vis,</span> <span class="hl kwd">aes</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= value,</span> <span class="hl kwc">y</span> <span class="hl std">= antigenic_score,</span> <span class="hl kwc">group</span> <span class="hl std">=</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl kwc">colour</span> <span class="hl std">= variant))</span> <span class="hl opt">+</span>
    <span class="hl kwd">theme_bw</span><span class="hl std">()</span> <span class="hl opt">+</span>
    <span class="hl kwd">geom_point</span><span class="hl std">(</span><span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">2.5</span><span class="hl std">)</span> <span class="hl opt">+</span>
    <span class="hl kwd">ylim</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">, ylim)</span> <span class="hl opt">+</span>
    <span class="hl kwd">scale_color_manual</span><span class="hl std">(</span><span class="hl kwc">values</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;#000000&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#E69F00&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#56B4E9&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#009E73&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#F0E442&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#0072B2&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#D55E00&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#CC79A7&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#999999&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#332288&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#b66dff&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;#999933&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;slategray1&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;violetred1&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;springgreen&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;slateblue&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;tomato&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;tan3&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;lightpink4&quot;</span><span class="hl std">))</span> <span class="hl opt">+</span>
    <span class="hl kwd">facet_wrap</span><span class="hl std">(</span><span class="hl opt">~</span><span class="hl std">comparison,</span> <span class="hl kwc">scales</span> <span class="hl std">=</span> <span class="hl str">&quot;free_x&quot;</span><span class="hl std">)</span> <span class="hl opt">+</span> <span class="hl com">#, strip.position = &quot;bottom&quot;</span>
    <span class="hl kwd">labs</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">=</span> <span class="hl kwa">NULL</span><span class="hl std">,</span> <span class="hl kwc">y</span> <span class="hl std">= ylabel)</span> <span class="hl opt">+</span>
    <span class="hl kwd">theme</span><span class="hl std">(</span><span class="hl kwc">text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">family</span> <span class="hl std">=</span> <span class="hl str">&quot;Helvetica&quot;</span><span class="hl std">),</span> <span class="hl kwc">strip.placement</span> <span class="hl std">=</span> <span class="hl str">&quot;outside&quot;</span><span class="hl std">,</span>
          <span class="hl kwc">strip.text.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">),</span> <span class="hl kwc">axis.text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">10</span><span class="hl std">),</span>
          <span class="hl kwc">axis.title.x</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">),</span> <span class="hl kwc">axis.title.y</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span> <span class="hl std">=</span> <span class="hl num">10</span><span class="hl std">),</span>
          <span class="hl kwc">legend.title</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">8</span><span class="hl std">),</span> <span class="hl kwc">legend.text</span> <span class="hl std">=</span> <span class="hl kwd">element_text</span><span class="hl std">(</span><span class="hl kwc">size</span><span class="hl std">=</span><span class="hl num">6</span><span class="hl std">))</span> <span class="hl opt">+</span>
    <span class="hl kwd">guides</span><span class="hl std">(</span><span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl kwd">guide_legend</span><span class="hl std">(</span><span class="hl kwc">ncol</span> <span class="hl std">=</span> <span class="hl num">3</span><span class="hl std">))</span>
  <span class="hl std">method_plt</span>
  <span class="hl com"># Saving plot</span>
  <span class="hl kwd">ggsave</span><span class="hl std">(method_plt,</span>
         <span class="hl kwc">filename</span> <span class="hl std">=</span> <span class="hl kwd">paste</span><span class="hl std">(output, file_name,</span> <span class="hl kwc">sep</span> <span class="hl std">=</span> <span class="hl str">&quot;&quot;</span><span class="hl std">),</span>
         <span class="hl kwc">device</span> <span class="hl std">=</span> <span class="hl str">&quot;pdf&quot;</span><span class="hl std">,</span>
         <span class="hl kwc">height</span> <span class="hl std">=</span> <span class="hl num">45</span><span class="hl std">,</span> <span class="hl kwc">width</span> <span class="hl std">=</span> <span class="hl num">180</span><span class="hl std">,</span> <span class="hl kwc">units</span> <span class="hl std">=</span> <span class="hl str">&quot;mm&quot;</span><span class="hl std">)</span>
  <span class="hl kwd">return</span><span class="hl std">(method_plt)</span>
<span class="hl std">}</span>

<span class="hl std">method_plt</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">scatterplot</span><span class="hl std">(method_df_vis,</span> <span class="hl num">22</span><span class="hl std">,</span> <span class="hl str">&quot;antigenicScores_with_weights_at_all_sites_comparison_mFRNA_antigenicCartography_2020-01-2023-12_45x180.pdf&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;Antigenic Alteration Scores&quot;</span><span class="hl std">)</span>
<span class="hl std">spikepro_plt</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">scatterplot</span><span class="hl std">(spikepro_df_vis,</span> <span class="hl num">18</span><span class="hl std">,</span> <span class="hl str">&quot;spikepro_scores_comparison_mFRNA_antigenicCartography_45x180.pdf&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;SpikePro Scores&quot;</span><span class="hl std">)</span>
<span class="hl std">method_plt</span>
</pre></div>
</div><div class="rimage center"><img src="figure/spikepro-comparison-Rhtmlauto-report-1.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_plt</span>
</pre></div>
</div><div class="rimage center"><img src="figure/spikepro-comparison-Rhtmlauto-report-2.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">## Statistical Testing Between Antigenic Distances and Scores</span>

<span class="hl com"># Data Set Up</span>

<span class="hl std">split_df_cartography</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">input_df</span><span class="hl std">) {</span>
  <span class="hl std">df_split_cartography</span> <span class="hl kwb">&lt;-</span> <span class="hl std">input_df[input_df</span><span class="hl opt">$</span><span class="hl std">comparison</span> <span class="hl opt">==</span> <span class="hl str">'Antigenic Distances'</span><span class="hl std">, ]</span>
  <span class="hl std">df_split_cartography</span><span class="hl opt">$</span><span class="hl std">antigenic_score</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.numeric</span><span class="hl std">(df_split_cartography</span><span class="hl opt">$</span><span class="hl std">antigenic_score)</span>
  <span class="hl kwd">return</span><span class="hl std">(df_split_cartography)</span>
<span class="hl std">}</span>

<span class="hl std">split_df_neutralization</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">input_df</span><span class="hl std">) {</span>
  <span class="hl std">split_df_neutralization</span> <span class="hl kwb">&lt;-</span> <span class="hl std">input_df[input_df</span><span class="hl opt">$</span><span class="hl std">comparison</span> <span class="hl opt">==</span> <span class="hl str">'mFRN Values'</span><span class="hl std">, ]</span>
  <span class="hl std">split_df_neutralization</span><span class="hl opt">$</span><span class="hl std">antigenic_score</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.numeric</span><span class="hl std">(split_df_neutralization</span><span class="hl opt">$</span><span class="hl std">antigenic_score)</span>
  <span class="hl kwd">return</span><span class="hl std">(split_df_neutralization)</span>
<span class="hl std">}</span>

<span class="hl com"># Method </span>
<span class="hl std">method_split_cartography</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">split_df_cartography</span><span class="hl std">(method_df_vis)</span>
<span class="hl std">method_split_neutralization</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">split_df_neutralization</span><span class="hl std">(method_df_vis)</span>
<span class="hl std">cartography_distances</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(method_split_cartography[</span><span class="hl str">'value'</span><span class="hl std">])</span> <span class="hl com"># Only need to do this once as its the same across all methods</span>
<span class="hl std">neutralization_values</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(method_split_neutralization[</span><span class="hl str">'value'</span><span class="hl std">])</span> <span class="hl com"># Only need to do this once as its the same across all methods</span>
<span class="hl std">method_antigenic_scores</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(method_split_cartography[</span><span class="hl str">'antigenic_score'</span><span class="hl std">])</span> <span class="hl com">#as.vector</span>
<span class="hl std">method_antigenic_scores_mfrn</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(method_split_neutralization[</span><span class="hl str">'antigenic_score'</span><span class="hl std">])</span> <span class="hl com">#as.vector</span>
<span class="hl std">cartography_distances</span>
</pre></div>
<div class="output"><pre class="knitr r">##    value
## 1    0.7
## 2    6.3
## 3    6.0
## 4    6.1
## 5    3.6
## 6    1.4
## 7    7.5
## 8    7.3
## 9    3.1
## 10   7.9
## 11   7.0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">neutralization_values</span>
</pre></div>
<div class="output"><pre class="knitr r">##     value
## 12   1.50
## 13 336.32
## 14 298.75
## 15 301.65
## 16 105.77
## 17  47.03
## 18  97.24
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">method_antigenic_scores</span>
</pre></div>
<div class="output"><pre class="knitr r">##    antigenic_score
## 1             3.70
## 2            15.36
## 3            13.60
## 4            15.95
## 5             4.92
## 6             1.99
## 7            18.12
## 8            21.15
## 9             5.38
## 10           18.79
## 11           19.61
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">method_antigenic_scores_mfrn</span>
</pre></div>
<div class="output"><pre class="knitr r">##    antigenic_score
## 12            3.70
## 13           15.36
## 14           13.60
## 15           15.95
## 16            4.92
## 17            1.99
## 18            5.38
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_split_cartography</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">split_df_cartography</span><span class="hl std">(spikepro_df_vis)</span>
<span class="hl std">spikepro_split_neutralization</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">split_df_neutralization</span><span class="hl std">(spikepro_df_vis)</span>
<span class="hl std">spikepro_cartography_distances</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(spikepro_split_cartography[</span><span class="hl str">'value'</span><span class="hl std">])</span> <span class="hl com"># Only need to do this once as its the same across all methods</span>
<span class="hl std">spikepro_neutralization_values</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(spikepro_split_neutralization[</span><span class="hl str">'value'</span><span class="hl std">])</span> <span class="hl com"># Only need to do this once as its the same across all methods</span>
<span class="hl std">spikepro_antigenic_scores</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(spikepro_split_cartography[</span><span class="hl str">'antigenic_score'</span><span class="hl std">])</span> <span class="hl com">#as.vector</span>
<span class="hl std">spikepro_antigenic_scores_mfrn</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.matrix</span><span class="hl std">(spikepro_split_neutralization[</span><span class="hl str">'antigenic_score'</span><span class="hl std">])</span> <span class="hl com">#as.vector</span>
<span class="hl std">spikepro_cartography_distances</span>
</pre></div>
<div class="output"><pre class="knitr r">##    value
## 1    0.7
## 2    6.3
## 3    6.0
## 4    6.1
## 5    3.6
## 6    1.4
## 7    7.5
## 8    7.3
## 9    3.1
## 10   7.9
## 11   7.0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_neutralization_values</span>
</pre></div>
<div class="output"><pre class="knitr r">##     value
## 12   1.50
## 13 336.32
## 14 298.75
## 15 301.65
## 16 105.77
## 17  47.03
## 18  97.24
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_antigenic_scores</span>
</pre></div>
<div class="output"><pre class="knitr r">##    antigenic_score
## 1              6.1
## 2             14.0
## 3             12.0
## 4             14.0
## 5              7.4
## 6              6.9
## 7             13.0
## 8             13.0
## 9              8.3
## 10            17.0
## 11            15.0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_antigenic_scores_mfrn</span>
</pre></div>
<div class="output"><pre class="knitr r">##    antigenic_score
## 12             6.1
## 13            14.0
## 14            12.0
## 15            14.0
## 16             7.4
## 17             6.9
## 18             8.3
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Perform Spearman's Correlation Test </span>
<span class="hl com"># Against Antigenic Distance</span>
<span class="hl std">method_spearmans</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cor.test</span><span class="hl std">(cartography_distances, method_antigenic_scores,</span> <span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">'spearman'</span><span class="hl std">,</span> <span class="hl kwc">exact</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl std">spikepro_spearmans</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cor.test</span><span class="hl std">(spikepro_cartography_distances, spikepro_antigenic_scores,</span> <span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">'spearman'</span><span class="hl std">,</span> <span class="hl kwc">exact</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;Method Spearman's Results on Antigenic Cartography Distances: &quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Method Spearman's Results on Antigenic Cartography Distances: &quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">method_spearmans</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## 	Spearman's rank correlation rho
## 
## data:  cartography_distances and method_antigenic_scores
## S = 22, p-value = 0.00016
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
## rho 
## 0.9
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;SpikePro Spearman's Results on Antigenic Cartography Distances: &quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;SpikePro Spearman's Results on Antigenic Cartography Distances: &quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_spearmans</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## 	Spearman's rank correlation rho
## 
## data:  spikepro_cartography_distances and spikepro_antigenic_scores
## S = 33.149, p-value = 0.000938
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.8493239
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Against mFRN Values</span>
<span class="hl std">method_spearmans_mfrn</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cor.test</span><span class="hl std">(neutralization_values, method_antigenic_scores_mfrn,</span> <span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">'spearman'</span><span class="hl std">,</span> <span class="hl kwc">exact</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl std">spikepro_spearmans_mfrn</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">cor.test</span><span class="hl std">(spikepro_neutralization_values, spikepro_antigenic_scores_mfrn,</span> <span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">'spearman'</span><span class="hl std">,</span> <span class="hl kwc">exact</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;Method Spearman's Results on mFRN Values: &quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;Method Spearman's Results on mFRN Values: &quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">method_spearmans_mfrn</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## 	Spearman's rank correlation rho
## 
## data:  neutralization_values and method_antigenic_scores_mfrn
## S = 6, p-value = 0.006807
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.8928571
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">print</span><span class="hl std">(</span><span class="hl str">&quot;SpikePro Spearman's Results on mFRN Values: &quot;</span><span class="hl std">)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;SpikePro Spearman's Results on mFRN Values: &quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">spikepro_spearmans_mfrn</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## 	Spearman's rank correlation rho
## 
## data:  spikepro_neutralization_values and spikepro_antigenic_scores_mfrn
## S = 2.5204, p-value = 0.0008055
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.9549937
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">knitr</span><span class="hl opt">::</span><span class="hl kwd">knit_exit</span><span class="hl std">()</span>
</pre></div>
</div></div>
</body>
</html>



