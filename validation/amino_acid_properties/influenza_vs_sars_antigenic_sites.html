
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.sng {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.def {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/center-img.min.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.org/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.48</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#!/usr/bin/env Rscript</span>

<span class="hl com">#### Influenza vs. SARS-CoV-2 antigenic amio acid changes</span>
<span class="hl com">#Author: Katrina Norwood</span>
<span class="hl com">#Last Updated: 11/02/25</span>

<span class="hl com"># Script to compare (using a Fishers Exact Test and ROC Curve) amino acid changes</span>
<span class="hl com"># in influenza that are antigenic, to those in SARS-CoV-2 that are found to be </span>
<span class="hl com"># antigenic in literature, to see any similarities between the two.</span>

<span class="hl com"># To run:</span>
<span class="hl com"># 1. start in the /Corona_Variant_Scoring/ home directory</span>
<span class="hl com"># 2. in command line run: ```Rscript validation/amino_acid_properties/influenza_vs_sars_antigenic_sites.R```</span>

<span class="hl kwd">library</span><span class="hl def">(dplyr)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Caricamento pacchetto: 'dplyr'
</pre></div>
<div class="message"><pre class="knitr r">## I seguenti oggetti sono mascherati da 'package:stats':
## 
##     filter, lag
</pre></div>
<div class="message"><pre class="knitr r">## I seguenti oggetti sono mascherati da 'package:base':
## 
##     intersect, setdiff, setequal, union
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl def">(stats)</span>
<span class="hl kwd">library</span><span class="hl def">(ggplot2)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Need help? Try Stackoverflow: https://stackoverflow.com/tags/ggplot2
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#install.packages(&quot;pROC&quot;)</span>
<span class="hl kwd">library</span><span class="hl def">(pROC)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Type 'citation(&quot;pROC&quot;)' for a citation.
</pre></div>
<div class="message"><pre class="knitr r">## 
## Caricamento pacchetto: 'pROC'
</pre></div>
<div class="message"><pre class="knitr r">## I seguenti oggetti sono mascherati da 'package:stats':
## 
##     cov, smooth, var
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#install.packages(&quot;plotROC&quot;)</span>
<span class="hl kwd">library</span><span class="hl def">(plotROC)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Caricamento pacchetto: 'plotROC'
</pre></div>
<div class="message"><pre class="knitr r">## Il seguente oggetto Ã¨ mascherato da 'package:pROC':
## 
##     ggroc
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Importing Data Inputs </span>

<span class="hl def">output</span> <span class="hl kwb">&lt;-</span> <span class="hl sng">&quot;validation/amino_acid_properties/&quot;</span>
<span class="hl def">aa_changes_master</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl def">(</span><span class="hl sng">&quot;validation/amino_acid_properties/viral_amino_acid_properties.csv&quot;</span><span class="hl def">,</span> <span class="hl kwc">sep</span> <span class="hl def">=</span> <span class="hl sng">&quot;,&quot;</span><span class="hl def">)</span>

<span class="hl com">## Data Cleaning &amp; Contingency Table</span>

<span class="hl com"># Making the comparison columns factors</span>
<span class="hl def">aa_changes_master</span> <span class="hl kwb">&lt;-</span> <span class="hl def">aa_changes_master</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">mutate_at</span><span class="hl def">(</span><span class="hl kwd">c</span><span class="hl def">(</span><span class="hl sng">'Influenza'</span><span class="hl def">,</span> <span class="hl sng">'SARS.CoV.2'</span><span class="hl def">), as.factor)</span>

<span class="hl com"># Defining a contingency table for the fisher's exact test</span>
<span class="hl def">contingency_table</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl def">(aa_changes_master</span><span class="hl opt">$</span><span class="hl def">Influenza, aa_changes_master</span><span class="hl opt">$</span><span class="hl def">SARS.CoV.2)</span>
<span class="hl def">contingency_table</span>
</pre></div>
<div class="output"><pre class="knitr r">##        
##         FALSE TRUE
##   FALSE   274   11
##   TRUE     58   37
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Creating a dataframe for the ROC curve analysis</span>
<span class="hl def">aa_changes_comparison</span> <span class="hl kwb">&lt;-</span> <span class="hl def">aa_changes_master[</span><span class="hl kwd">c</span><span class="hl def">(</span><span class="hl sng">&quot;Weight&quot;</span><span class="hl def">,</span> <span class="hl sng">&quot;Influenza&quot;</span><span class="hl def">,</span> <span class="hl sng">&quot;SARS.CoV.2&quot;</span><span class="hl def">)]</span>

<span class="hl com"># Creating a dataframe for the F1-score</span>
<span class="hl com"># Here we turn the NA values in the weight column to 0, as the aa changes are not</span>
<span class="hl com"># considered antigenic</span>
<span class="hl def">aa_changes_f1score</span> <span class="hl kwb">&lt;-</span> <span class="hl def">aa_changes_comparison</span> <span class="hl opt">%&gt;%</span> <span class="hl kwd">replace</span><span class="hl def">(</span><span class="hl kwd">is.na</span><span class="hl def">(.),</span> <span class="hl num">0</span><span class="hl def">)</span>

<span class="hl com">## Fishers Exact Test</span>

<span class="hl kwd">fisher.test</span><span class="hl def">(contingency_table)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## 	Fisher's Exact Test for Count Data
## 
## data:  contingency_table
## p-value = 2.88e-16
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##   7.337868 36.254747
## sample estimates:
## odds ratio 
##   15.72299
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## ROC Comparison</span>

<span class="hl def">roc_curve_sars</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">roc</span><span class="hl def">(</span><span class="hl kwd">as.numeric</span><span class="hl def">(aa_changes_f1score</span><span class="hl opt">$</span><span class="hl def">SARS.CoV.2), aa_changes_f1score</span><span class="hl opt">$</span><span class="hl def">Weight)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Setting levels: control = 1, case = 2
</pre></div>
<div class="message"><pre class="knitr r">## Setting direction: controls &lt; cases
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl def">auc_value</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">auc</span><span class="hl def">(roc_curve_sars)</span>
<span class="hl kwd">print</span><span class="hl def">(</span><span class="hl kwd">paste</span><span class="hl def">(</span><span class="hl sng">&quot;AUC:&quot;</span><span class="hl def">,</span> <span class="hl kwd">round</span><span class="hl def">(auc_value,</span> <span class="hl num">2</span><span class="hl def">)))</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;AUC: 0.8&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Fishers Exact Test and F1-Score at Different Thresholds (Without Shuffling)</span>

<span class="hl def">threshold_fisher</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl def">(</span><span class="hl kwc">weights</span><span class="hl def">,</span> <span class="hl kwc">df</span><span class="hl def">) {</span> <span class="hl com">#actual_labels</span>
  <span class="hl com"># Calculates the Fishers Exact Test at different weight thresholds</span>
  <span class="hl def">weights</span> <span class="hl kwb">&lt;-</span> <span class="hl def">weights[</span><span class="hl kwd">is.finite</span><span class="hl def">(weights)]</span>
  <span class="hl def">thresholds</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">seq</span><span class="hl def">(</span><span class="hl kwd">min</span><span class="hl def">(weights,</span> <span class="hl kwc">na.rm</span> <span class="hl def">=</span> <span class="hl num">TRUE</span><span class="hl def">),</span> <span class="hl kwd">max</span><span class="hl def">(weights,</span> <span class="hl kwc">na.rm</span> <span class="hl def">=</span> <span class="hl num">TRUE</span><span class="hl def">),</span> <span class="hl kwc">length.out</span> <span class="hl def">=</span> <span class="hl num">100</span><span class="hl def">)</span>
  <span class="hl com">#print(thresholds)</span>
  <span class="hl def">p_values</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sapply</span><span class="hl def">(thresholds,</span> <span class="hl kwa">function</span><span class="hl def">(</span><span class="hl kwc">t</span><span class="hl def">) {</span>
    <span class="hl com">#df_threshold &lt;- df %&gt;% filter(df$Weight &gt; t)</span>
    <span class="hl def">df_temp</span> <span class="hl kwb">&lt;-</span> <span class="hl def">df</span>
    <span class="hl def">df_temp</span><span class="hl opt">$</span><span class="hl def">Influenza</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.logical</span><span class="hl def">(df_temp</span><span class="hl opt">$</span><span class="hl def">Influenza)</span>
    <span class="hl def">df_temp</span><span class="hl opt">$</span><span class="hl def">Influenza</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ifelse</span><span class="hl def">(df_temp</span><span class="hl opt">$</span><span class="hl def">Weight</span> <span class="hl opt">&lt;=</span> <span class="hl def">t,</span> <span class="hl num">FALSE</span><span class="hl def">, df_temp</span><span class="hl opt">$</span><span class="hl def">Influenza)</span>
    <span class="hl com">#print(head(df_temp))</span>
    <span class="hl def">table_values</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">table</span><span class="hl def">(df_temp</span><span class="hl opt">$</span><span class="hl def">Influenza, df_temp</span><span class="hl opt">$</span><span class="hl def">SARS.CoV.2)</span>

    <span class="hl kwa">if</span> <span class="hl def">(</span><span class="hl kwd">nrow</span><span class="hl def">(table_values)</span> <span class="hl opt">==</span> <span class="hl num">2</span> <span class="hl opt">&amp;&amp;</span> <span class="hl kwd">ncol</span><span class="hl def">(table_values)</span> <span class="hl opt">==</span> <span class="hl num">2</span><span class="hl def">) {</span>
      <span class="hl kwd">return</span><span class="hl def">(</span><span class="hl kwd">fisher.test</span><span class="hl def">(table_values)</span><span class="hl opt">$</span><span class="hl def">p.value)</span>
    <span class="hl def">}</span> <span class="hl kwa">else</span> <span class="hl def">{</span>
      <span class="hl kwd">return</span><span class="hl def">(</span><span class="hl num">NA</span><span class="hl def">)}})</span>

  <span class="hl def">f1_scores</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sapply</span><span class="hl def">(thresholds,</span> <span class="hl kwa">function</span> <span class="hl def">(</span><span class="hl kwc">t</span><span class="hl def">) {</span>
    <span class="hl def">df_temp2</span> <span class="hl kwb">&lt;-</span> <span class="hl def">df</span>
    <span class="hl def">df_temp2</span><span class="hl opt">$</span><span class="hl def">Influenza</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.logical</span><span class="hl def">(df_temp2</span><span class="hl opt">$</span><span class="hl def">Influenza)</span>
    <span class="hl def">df_temp2</span><span class="hl opt">$</span><span class="hl def">Influenza</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ifelse</span><span class="hl def">(df_temp2</span><span class="hl opt">$</span><span class="hl def">Weight</span> <span class="hl opt">&lt;=</span> <span class="hl def">t,</span> <span class="hl num">FALSE</span><span class="hl def">, df_temp2</span><span class="hl opt">$</span><span class="hl def">Influenza)</span>
    <span class="hl com">#print(head(df_temp2))</span>
    <span class="hl com">#print(t)</span>
    <span class="hl def">pred</span> <span class="hl kwb">&lt;-</span> <span class="hl def">df_temp2</span><span class="hl opt">$</span><span class="hl def">SARS.CoV.2</span>
    <span class="hl def">actual</span> <span class="hl kwb">&lt;-</span> <span class="hl def">df_temp2</span><span class="hl opt">$</span><span class="hl def">Influenza</span>

    <span class="hl def">tp</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl def">(pred</span> <span class="hl opt">==</span> <span class="hl num">TRUE</span> <span class="hl opt">&amp;</span> <span class="hl def">actual</span> <span class="hl opt">==</span> <span class="hl num">TRUE</span><span class="hl def">)</span>
    <span class="hl def">fp</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl def">(pred</span> <span class="hl opt">==</span> <span class="hl num">TRUE</span> <span class="hl opt">&amp;</span> <span class="hl def">actual</span> <span class="hl opt">==</span> <span class="hl num">FALSE</span><span class="hl def">)</span>
    <span class="hl def">fn</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">sum</span><span class="hl def">(pred</span> <span class="hl opt">==</span> <span class="hl num">FALSE</span> <span class="hl opt">&amp;</span> <span class="hl def">actual</span> <span class="hl opt">==</span> <span class="hl num">TRUE</span><span class="hl def">)</span>

    <span class="hl def">precision</span> <span class="hl kwb">&lt;-</span> <span class="hl def">tp</span> <span class="hl opt">/</span> <span class="hl def">(tp</span> <span class="hl opt">+</span> <span class="hl def">fp)</span>
    <span class="hl def">recall</span> <span class="hl kwb">&lt;-</span> <span class="hl def">tp</span> <span class="hl opt">/</span> <span class="hl def">(tp</span> <span class="hl opt">+</span> <span class="hl def">fn)</span>

    <span class="hl kwa">if</span> <span class="hl def">(</span><span class="hl kwd">is.nan</span><span class="hl def">(precision)</span> <span class="hl opt">||</span> <span class="hl kwd">is.nan</span><span class="hl def">(recall)) {</span>
      <span class="hl def">f1_score</span> <span class="hl kwb">&lt;-</span> <span class="hl num">0</span><span class="hl def">}</span> <span class="hl kwa">else</span> <span class="hl def">{</span>
        <span class="hl def">f1_score</span> <span class="hl kwb">&lt;-</span> <span class="hl num">2</span> <span class="hl opt">*</span> <span class="hl def">(precision</span> <span class="hl opt">*</span> <span class="hl def">recall)</span> <span class="hl opt">/</span> <span class="hl def">(precision</span> <span class="hl opt">+</span> <span class="hl def">recall)</span>
      <span class="hl def">}</span>
    <span class="hl kwd">return</span><span class="hl def">(f1_score)})</span>
    <span class="hl com">#fisher.test(table_values)$p.value})</span>
  <span class="hl kwd">return</span><span class="hl def">(</span><span class="hl kwd">list</span><span class="hl def">(thresholds, p_values, f1_scores))}</span>

<span class="hl def">fishers_threshold_results</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">threshold_fisher</span><span class="hl def">(aa_changes_f1score</span><span class="hl opt">$</span><span class="hl def">Weight, aa_changes_f1score)</span>
<span class="hl def">fishers_threshold_df</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl def">(fishers_threshold_results[[</span><span class="hl num">1</span><span class="hl def">]], fishers_threshold_results[[</span><span class="hl num">2</span><span class="hl def">]],</span>
                                   <span class="hl def">fishers_threshold_results[[</span><span class="hl num">3</span><span class="hl def">]])</span>

<span class="hl com">## Visualizations</span>

<span class="hl com"># Fishers Exact Test and F1 Scores at Different Thresholds Without Shuffling</span>
<span class="hl def">fishers_threshold_df_plot</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">na.omit</span><span class="hl def">(fishers_threshold_df)</span>

<span class="hl def">pvalue_threshold_plt</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">ggplot</span><span class="hl def">(fishers_threshold_df_plot,</span> <span class="hl kwd">aes</span><span class="hl def">(</span><span class="hl kwc">x</span> <span class="hl def">= fishers_threshold_results..1..))</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_line</span><span class="hl def">(</span><span class="hl kwd">aes</span><span class="hl def">(</span><span class="hl kwc">y</span> <span class="hl def">= fishers_threshold_results..2..,</span> <span class="hl kwc">color</span> <span class="hl def">=</span> <span class="hl sng">&quot;P-Value&quot;</span><span class="hl def">),</span> <span class="hl kwc">linewidth</span> <span class="hl def">=</span> <span class="hl num">1.2</span><span class="hl def">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">geom_line</span><span class="hl def">(</span><span class="hl kwd">aes</span><span class="hl def">(</span><span class="hl kwc">y</span> <span class="hl def">= fishers_threshold_results..3..,</span> <span class="hl kwc">color</span> <span class="hl def">=</span> <span class="hl sng">&quot;F1 Score&quot;</span><span class="hl def">),</span>
            <span class="hl kwc">linewidth</span> <span class="hl def">=</span> <span class="hl num">1.2</span><span class="hl def">,</span> <span class="hl kwc">linetype</span> <span class="hl def">=</span> <span class="hl sng">&quot;solid&quot;</span><span class="hl def">,</span> <span class="hl kwc">show.legend</span> <span class="hl def">=</span> <span class="hl num">TRUE</span><span class="hl def">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_y_continuous</span><span class="hl def">(</span>
    <span class="hl kwc">name</span> <span class="hl def">=</span> <span class="hl sng">&quot;P-Value&quot;</span><span class="hl def">,</span>
    <span class="hl kwc">sec.axis</span> <span class="hl def">=</span> <span class="hl kwd">sec_axis</span><span class="hl def">(</span><span class="hl opt">~</span> <span class="hl def">.</span> <span class="hl opt">*</span> <span class="hl kwd">max</span><span class="hl def">(fishers_threshold_df_plot</span><span class="hl opt">$</span><span class="hl def">fishers_threshold_results..3..)</span> <span class="hl opt">/</span> <span class="hl kwd">max</span><span class="hl def">(fishers_threshold_df_plot</span><span class="hl opt">$</span><span class="hl def">fishers_threshold_results..2..),</span>
                        <span class="hl kwc">name</span> <span class="hl def">=</span> <span class="hl sng">&quot;F1 Score&quot;</span><span class="hl def">)</span>
  <span class="hl def">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">scale_color_manual</span><span class="hl def">(</span><span class="hl kwc">values</span> <span class="hl def">=</span> <span class="hl kwd">c</span><span class="hl def">(</span><span class="hl sng">&quot;P-Value&quot;</span> <span class="hl def">=</span> <span class="hl sng">&quot;#1C86EE&quot;</span><span class="hl def">,</span> <span class="hl sng">&quot;F1 Score&quot;</span> <span class="hl def">=</span> <span class="hl sng">&quot;orange&quot;</span><span class="hl def">))</span> <span class="hl opt">+</span>
  <span class="hl kwd">labs</span><span class="hl def">(</span><span class="hl kwc">x</span> <span class="hl def">=</span> <span class="hl sng">&quot;Antigenic Weight Threshold&quot;</span><span class="hl def">,</span> <span class="hl kwc">color</span> <span class="hl def">=</span> <span class="hl sng">&quot;Metric&quot;</span><span class="hl def">)</span> <span class="hl opt">+</span>  <span class="hl com"># Removed title</span>
  <span class="hl kwd">theme_minimal</span><span class="hl def">(</span><span class="hl kwc">base_size</span> <span class="hl def">=</span> <span class="hl num">10</span><span class="hl def">)</span> <span class="hl opt">+</span>
  <span class="hl kwd">theme</span><span class="hl def">(</span><span class="hl kwc">panel.background</span> <span class="hl def">=</span> <span class="hl kwd">element_rect</span><span class="hl def">(</span><span class="hl kwc">fill</span> <span class="hl def">=</span> <span class="hl sng">&quot;white&quot;</span><span class="hl def">),</span>
        <span class="hl kwc">plot.background</span> <span class="hl def">=</span> <span class="hl kwd">element_rect</span><span class="hl def">(</span><span class="hl kwc">fill</span> <span class="hl def">=</span> <span class="hl sng">&quot;white&quot;</span><span class="hl def">),</span>
        <span class="hl kwc">plot.title</span> <span class="hl def">=</span> <span class="hl kwd">element_text</span><span class="hl def">(</span><span class="hl kwc">hjust</span> <span class="hl def">=</span> <span class="hl num">0.5</span><span class="hl def">,</span> <span class="hl kwc">size</span> <span class="hl def">=</span> <span class="hl num">10</span><span class="hl def">))</span>
<span class="hl def">pvalue_threshold_plt</span>
</pre></div>
</div><div class="rimage center"><img src="figure/influenza-vs-sars-antigenic-sites-Rhtmlauto-report-1.png" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">#ggsave(paste(output, &quot;sarscov2_v_influenza_fishers_and_f1score_nonshuffled_90x90.pdf&quot;, sep = &quot;&quot;), plot = fishers_plt, </span>
<span class="hl com">#       width = 90, height = 90, units = c(&quot;mm&quot;), dpi = 300)</span>

<span class="hl com"># ROC Curve</span>
<span class="hl com"># Extract ROC curve data (fpr, tpr, thresholds)</span>
<span class="hl kwd">plot.roc</span><span class="hl def">(roc_curve_sars,</span> <span class="hl kwc">col</span> <span class="hl def">=</span> <span class="hl sng">&quot;blue&quot;</span><span class="hl def">)</span>
<span class="hl kwd">text</span><span class="hl def">(</span><span class="hl kwc">x</span> <span class="hl def">=</span> <span class="hl num">0.6</span><span class="hl def">,</span> <span class="hl kwc">y</span> <span class="hl def">=</span> <span class="hl num">0.2</span><span class="hl def">,</span> <span class="hl kwc">labels</span> <span class="hl def">=</span> <span class="hl kwd">paste</span><span class="hl def">(</span><span class="hl sng">&quot;AUC = &quot;</span><span class="hl def">,</span> <span class="hl kwd">round</span><span class="hl def">(auc_value,</span> <span class="hl num">3</span><span class="hl def">)),</span>
     <span class="hl kwc">col</span> <span class="hl def">=</span> <span class="hl sng">&quot;red&quot;</span><span class="hl def">,</span> <span class="hl kwc">cex</span> <span class="hl def">=</span> <span class="hl num">1.2</span><span class="hl def">)</span>
</pre></div>
</div><div class="rimage center"><img src="figure/influenza-vs-sars-antigenic-sites-Rhtmlauto-report-2.png" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl def">knitr</span><span class="hl opt">::</span><span class="hl kwd">knit_exit</span><span class="hl def">()</span>
</pre></div>
</div></div>
</body>
</html>



